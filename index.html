<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Red Hat Quest v2.1</title>
    <link rel="icon" type="image/png" href="assets/red_hat_icon.png">
    
    <!-- Development: Prevent caching -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <link rel="stylesheet" href="style.css?v=dev">
    
    <!-- Development: Cache-busting script to add timestamps to imports -->
    <script>
        // Add timestamp to dynamic imports for cache busting
        window.cacheBuster = Date.now();
    </script>
</head>
<body>
    <!-- Registration Overlay -->
    <div id="registrationOverlay" class="registration-overlay">
        <div class="registration-box">
            <div class="registration-header">
                <h1>üéÆ Welcome to Red Hat Quest v2.2</h1>
                <p>Enter your email address to create your player profile and start your adventure!</p>
            </div>
            
            <form class="registration-form">
                <div class="form-group">
                    <label for="emailInput">Email Address</label>
                    <input type="email" id="emailInput" placeholder="Enter your email address" required>
                    <div id="emailError" class="error-message"></div>
                </div>
                
                <button type="button" id="registerButton" class="register-button">
                    Register & Start Playing
                </button>
                
                <div id="registrationLoading" class="loading-message" style="display: none;">
                    <div class="loading-spinner"></div>
                    <p>Creating your username...</p>
                </div>
            </form>
        </div>
    </div>
    
    <div id="game-container" style="display: none;">
        <div id="game-header">
            <div class="header-content">
                <div class="counter-group">
                    <img src="assets/coin.png" alt="Coins" class="counter-icon">
                    <span id="coinCount">0</span>
                </div>
                <h1 class="game-title">Red Hat Quest v2.1</h1>
                <div class="lives-section">
                    <span class="lives-label"></span>
                    <div id="redHatCounters" class="red-hat-counters"></div>
                </div>
            </div>
        </div>
        
        <div id="game-area">
            <div id="canvas-container">
                <canvas id="gameCanvas"></canvas>
                
                <!-- Pause Overlay - positioned directly over canvas -->
                <div id="pauseOverlay" style="display:none;">
                    <div class="pause-overlay-content">
                        <div class="pause-icon">‚è∏Ô∏è</div>
                        <h2>Game is paused by Administrators</h2>
                        <p>Please wait while the game is paused...</p>
                    </div>
                </div>
                
                <!-- Game Over Overlay -->
                <div id="gameOverlay" style="display:none;">
                    <div class="overlay-content">
                        <h2 id="overlayTitle">Game Over!</h2>
                        <div class="overlay-buttons">
                            <button id="checkoutButton">Checkout</button>
                            <button id="restartButton">Restart Game</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="game-bottom-bar">
                <div class="bottom-counter">
                    <img src="assets/t_shirt_rhel.png" alt="T-Shirts" class="bottom-icon">
                    <span>T-Shirts: </span>
                    <span id="tshirtTotal">0</span>
                </div>
                <div class="bottom-user-info">
                    <span class="user-id-label">User ID: </span>
                    <span id="userIdDisplay">Not registered</span>
                </div>
            </div>
        </div>
        

        
        <div id="orderConfirmationOverlay" style="display:none;">
            <div class="order-confirmation-box">
                <div class="order-header">
                    <h1>Order Confirmation</h1>
                    <p>Please review your order before placing it</p>
                </div>
                
                <div class="order-section order-items">
                    <h3>Your Items:</h3>
                    <div id="orderItemsList" class="order-items-list">
                        <!-- Order items will be populated here by JavaScript -->
                    </div>
                </div>

                <div class="order-section order-summary">
                    <div class="order-total">
                        <span>Total: <span id="orderTotal">¬£0</span></span>
                    </div>
                </div>

                <div class="order-actions">
                    <button id="cancelOrderButton" class="order-button cancel-button">Not good enough, give me another go!</button>
                    <button id="placeOrderButton" class="order-button place-order-button">Great score! Submit my Order</button>
                </div>
            </div>
        </div>

        <div id="invoiceOverlay" style="display:none;">
            <div class="invoice-box">
                <div class="invoice-header">
                    <div class="invoice-logo">
                        <h1>RedHat Quest v2.1</h1>
                    </div>
                    <div class="invoice-details">
                        <h2>INVOICE</h2>
                        <p><strong>Invoice #:</strong> <span id="invoiceNumber"></span></p>
                        <p><strong>Date:</strong> <span id="invoiceDate"></span></p>
                    </div>
                </div>
                
                <div class="invoice-section customer-info">
                    <h3>Bill To: <span id="invoicePlayerName">Player Character</span></h3>
                </div>

                <div class="invoice-section item-table">
                    <table>
                        <thead>
                            <tr>
                                <th>Item Description</th>
                                <th>Qty</th>
                                <th>Unit Price</th>
                                <th>Line Total</th>
                            </tr>
                        </thead>
                                                <tbody id="invoiceItems">
                        </tbody>
                        <tfoot>
                            <tr class="subtotal-row">
                                <td colspan="3" style="text-align: right;"><strong>Subtotal:</strong></td>
                                <td style="text-align: right;"><strong id="invoiceSubtotal">¬£0</strong></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>

                <div class="invoice-section invoice-summary">
                    <div class="summary-row total-row">
                        <span>TOTAL:</span>
                        <span id="invoiceTotal">¬£0</span>
                    </div>
                </div>

                <button id="closeInvoiceButton">Close Invoice</button>
            </div>
        </div>
        

    </div>

    <!-- Configuration loading -->
    <script type="module" src="js/config.js"></script>
    <script src="js/config-loader.js"></script>
    
    <!-- Main application -->
    <script type="module" src="js/main.js?v=dev"></script>
</body>
</html>